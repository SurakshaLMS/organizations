# ============================================================================
# DATABASE CONFIGURATION (Google Cloud SQL)
# ============================================================================
# Single source of truth for all database connections
DATABASE_URL="mysql://root:Skaveesha1355660%40@34.29.9.105:3306/suraksha-lms-db?connection_limit=10&pool_timeout=120&connect_timeout=120&sslmode=disable"

# Database connection details (used by Prisma and application)
DB_HOST=34.29.9.105
DB_PORT=3306
DB_USERNAME=root
DB_PASSWORD=Skaveesha1355660@
DB_DATABASE=suraksha-lms-db

# JWT Configuration
JWT_SECRET="your-super-secret-jwt-key-change-this-in-production-2024"
JWT_EXPIRES_IN="7d"
JWT_REFRESH_SECRET="your-super-secret-jwt-refresh-key-change-this-in-production-2024"
JWT_REFRESH_EXPIRES_IN="30d"

# Main Backend JWT Configuration (for Organization Manager tokens)
# This secret is used to verify JWT tokens from the main backend AND as static OM_TOKEN
OM_TOKEN="v9Jz3Xq7Lk2p8Yt5Wm1r4Bv6Qe9Tn0HsXc3Zg7Ua5Md2Rf8KjLq6Np1YwVb4Ez7C"

# Security Configuration
BCRYPT_SALT_ROUNDS=12
BCRYPT_PEPPER=4f8a7b2c9e1d6f3a8b5c9e2d7f1a4b8c5e9d2f6a3b7c0e4d8f1a5b9c2e6d9f3a
PASSWORD_ENCRYPTION_KEY="4f8a7b2c9e1d6f3a8b5c9e2d7f1a4b8c5e9d2f6a3b7c0e4d8f1a5b9c2e6d9f3a"
PASSWORD_ENCRYPTION_IV_LENGTH=12

# XSS & Injection Protection
XSS_PROTECTION=true
ENABLE_CSRF=false
CSRF_SECRET="change-this-csrf-secret-in-production-2024"

# Enhanced Authentication Security
THROTTLE_LIMIT_LOGIN=5
LOGIN_ATTEMPT_WINDOW=900000  # 15 minutes
PASSWORD_MIN_LENGTH=8
PASSWORD_REQUIRE_UPPERCASE=true
PASSWORD_REQUIRE_LOWERCASE=true
PASSWORD_REQUIRE_NUMBERS=true
PASSWORD_REQUIRE_SPECIAL=false



# Application Configuration
PORT=8080  # Cloud Run compatible (changed from 3000)
NODE_ENV="development"

# Request Size Limits (DoS Protection)
REQUEST_SIZE_LIMIT=10mb
MAX_FILE_SIZE=10485760  # 10MB in bytes
MAX_FILES_PER_REQUEST=10

# Query Parameter Limits (Bulk Abuse Protection)
MAX_PAGINATION_LIMIT=100
MAX_PAGE_NUMBER=1000
MAX_SEARCH_LENGTH=200
MAX_OFFSET=100000

# Storage Configuration - GOOGLE CLOUD STORAGE ONLY
STORAGE_PROVIDER=google

# Google Cloud Storage Configuration (File uploads)
GCS_PROJECT_ID=earnest-radio-475808-j8
GCS_BUCKET_NAME=suraksha-lms
GCS_PRIVATE_KEY_ID=117db7f80c9d18867a3f96db283bec8afecf6be3
GCS_PRIVATE_KEY="-----BEGIN PRIVATE KEY-----\nMIIEvQIBADANBgkqhkiG9w0BAQEFAASCBKcwggSjAgEAAoIBAQClJL5BKfLef2l+\n270+cAIv+1kgfxtGb+F07m9MYdFJQFi6DRe7NQD6tyGAQYy81Tv/bQ8WLq5yipvw\npuJL26zzbkqWaCZIS40chLpl7KrtgvhBVzbnklf+HqBg3IehPUTwyEPZdQSvjn00\nxEHfTsD5dFJYia5hX2ZPJSNKq1Cl+FHa156GAHR5Cj6t+2HJmRTqUI20gNQmciPm\n0Ori3RkJ9SdZg3W4ROXB7qZqMy7iepwixDOgCMJXXyJJhoBvz5QV6m/2AojvMBh3\n82Cs1OITk3nbw/s9HyUcsOve8kJgRBjclNUI+Qk8NV+Z01GjGQwau9+/G8GNGHvt\naI4lzP/LAgMBAAECggEASsTf/tDnTSWStgT3IZXE58R9DeF+j92HzlFFwudmwiuI\nAHR9Eh1lXB4d5NvIxJYmm/bcpcZs5R8si0CDpKTJIU4GJyLwcjsCoK7XVd5ZZT+u\n9qZuDVqMzFlBc5llLvN2iy2gyovYm0OAHKvexyP46vhnb/6mHR/8SkkeOWhnEz0n\n2apZYnSt3Jbp2joxsdDZ9OQLVpqol6rewlvTiLSRE1DOswZOT9g4LAlevj5q+mmE\nlQsfgUu3MyNeQzvrg/h4QSzLMu3ypSnmRmRQqT8W4Cio5L32eK4Sb9gRXMyhFz9g\nwi+CQZogJc2jrtBLXlfDfeNm9IlH/0LJAuP+VXMFgQKBgQDdzcMtJCV0m1QKK0Ci\n9t/4K4S7Yt37XA7LcJIJ5o/D+zdiFlOKl7On8+vrbxspBm+GtVvS0pnoZYMTx86f\ngh9ZocogVkNpZwS5NoA7qaLkuSZ4Somnq8Z9UaTHXoKssSujbds3PtrRPthsWw1r\n7oXv+XS5CdkaKci4BiC9lOi5owKBgQC+mrFNT8nhJADUoVcLeKDab3BdycAeabp2\nyUGFFEBo782ydKHccQ8RLiTfOGjEa5GdaWgzatfCaxuc+o5FAqLwli3e2HjhYsop\nEkkwE7GKO3BytzMNLYCXhajPfpbx7pdR34DpW7cV9nrkgVgidLPyvMre/tXEpfZP\nsQ49icVTuQKBgQDAx3MpC+6mD88WW4t9WLdHWoOt3ntzWgrd1USI6GTyAKmdTixk\nHAAhLQdTBKmFmbtbSMu7TCJK89feXF6BErauz8j/HBrRRKG9XNpNgN48j5QZHyfP\nnKQTDd/7DHDlKcP08qmCtdW34jh2zRi4Q4MUFSvXG/EfJUv4bhMM050GowKBgCWG\nwVeuWNnZw8wZQ9D/W/QFssLUYN3cBRk0AJFZ7mB6ri3vZprHK6c/RYUpTv81CoNK\naHiPFZGyksoyTmZp4XiqqLdSOWJul8zES+KKTg8gKsB7LzLt/X5Xk2fezYsuZV56\nOaA4LXDGiWWJzbdi8Lbe0rZax+2imz8PZfVZtZ8JAoGAayKwKvSPaBqP/JMx+QrQ\nS0okoHoLFUj2LrmrEYPWcNrSuCvNbyVvEmp7GkiQ6tAHx8xrlfzYLYYbA0sYJXDv\nc7LIzZv3mSHivU43AXcSqKe6aBl9MKGNbNSr6BzwpdIc75n5gzGRXPIq+9pf7R+H\n1VSGwHwdZXG68F1GSBE1YLA=\n-----END PRIVATE KEY-----\n"
GCS_CLIENT_EMAIL=suraksha-lms-bucket@earnest-radio-475808-j8.iam.gserviceaccount.com
GCS_CLIENT_ID=103372710019303262911
GCS_AUTH_URI=https://accounts.google.com/o/oauth2/auth
GCS_TOKEN_URI=https://oauth2.googleapis.com/token
GCS_AUTH_PROVIDER_X509_CERT_URL=https://www.googleapis.com/oauth2/v1/certs
GCS_UNIVERSE_DOMAIN=googleapis.com

# File Upload & URL Transformation - Used by @AfterLoad hooks in entities
GCS_BASE_URL=https://storage.googleapis.com/suraksha-lms

# Rate Limiting (DoS & Brute Force Protection)
RATE_LIMIT_WINDOW_MS=900000  # 15 minutes
RATE_LIMIT_MAX_REQUESTS=100
THROTTLE_TTL_DEFAULT=60000  # 1 minute
THROTTLE_LIMIT_DEFAULT=100
THROTTLE_TTL_LOGIN=300000  # 5 minutes (brute force protection)
THROTTLE_LIMIT_LOGIN=3  # Max 3 login attempts per 5 minutes

# User Sync Configuration
USER_SYNC_ENABLED=true
USER_SYNC_CRON="0 2 * * *"  # Daily at 2 AM

# CORS Configuration (Cross-Origin Protection)
CORS_ORIGIN=http://localhost:8080,https://yourdomain.com,https://org.suraksha.lk
CORS_METHODS=GET,HEAD,PUT,PATCH,POST,DELETE,OPTIONS
CORS_CREDENTIALS=true
# Development: Allow all origins (commented out for dev mode)
# ALLOWED_ORIGINS=

# HTTPS/SSL Configuration (MITM Protection)
HTTPS_ENABLED=false
FORCE_HTTPS=false
# Production: Enable HTTPS
# HTTPS_ENABLED=true
# FORCE_HTTPS=true
# SSL_CERT_PATH=/path/to/cert.pem
# SSL_KEY_PATH=/path/to/key.pem

# Security Headers (Production)
HSTS_MAX_AGE=31536000  # 1 year
HSTS_INCLUDE_SUBDOMAINS=true
HSTS_PRELOAD=true
X_FRAME_OPTIONS=DENY
X_CONTENT_TYPE_OPTIONS=nosniff
X_XSS_PROTECTION=true
REFERRER_POLICY=strict-origin-when-cross-origin

# Swagger Configuration (Disable in Production)
ENABLE_SWAGGER=false
SWAGGER_ENABLED=false  # Set to false in production
SWAGGER_TITLE="Organization Service API"
SWAGGER_DESCRIPTION="API documentation for the Organization Service"
SWAGGER_VERSION="1.0.0"
SWAGGER_PATH="/api-docs"

# Logging Configuration
LOG_LEVEL=warn  # development: debug | production: warn
LOG_TO_FILE=true
LOG_FILE_PATH=./logs
LOG_MAX_FILES=14  # Keep logs for 14 days
LOG_DATE_PATTERN=YYYY-MM-DD

# Monitoring & Health Checks
HEALTH_CHECK_ENABLED=true
METRICS_ENABLED=true

# Session Security
SESSION_SECRET="change-this-session-secret-in-production-2024"
SESSION_COOKIE_SECURE=true  # Set to true in production (requires HTTPS)
SESSION_COOKIE_HTTP_ONLY=true
SESSION_COOKIE_SAME_SITE=strict
SESSION_MAX_AGE=86400000  # 24 hours

# ============================================================================
# SIGNED URL FILE UPLOAD LIMITS (Cost-Optimized Direct Upload)
# ============================================================================
# 10-minute private TTL, verification required to make public
# Supports large files (direct to GCS/S3, bypasses backend)

# Profile & User Images
MAX_PROFILE_IMAGE_SIZE=5242880      # 5MB
MAX_STUDENT_IMAGE_SIZE=5242880       # 5MB
MAX_INSTITUTE_IMAGE_SIZE=5242880    # 5MB

# Documents
MAX_LECTURE_DOCUMENT_SIZE=5242880   # 5MB
MAX_LECTURE_COVER_SIZE=5242880       # 5MB
MAX_HOMEWORK_SIZE=5242880           # 5MB
MAX_CORRECTION_SIZE=5242880         # 5MB

# Media & Large Files
MAX_ADVERTISEMENT_SIZE=10485760     # 10MB (videos, etc.)

# Signed URL TTL (in minutes)
SIGNED_URL_TTL_MINUTES=10            # Short TTL for cost savings
